<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatório PDF</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>

    <div id="pdf-content">
        <h1>Relatório de Solicitação de Serviço</h1>

        <p><strong>Tipo de Serviço:</strong> <span id="tipo_servico"></span></p>
        <p><strong>Opção 1:</strong> <span id="subserviço"></span></p>
        <p><strong>Opção 2:</strong> <span id="detalhe"></span></p>

        <h2>Informações do Solicitante</h2>
        <p><strong>Nome:</strong> <span id="nome"></span></p>
        <p><strong>E-mail:</strong> <span id="email"></span></p>
        <p><strong>Telefone 1:</strong> <span id="telefone1"></span></p>
        <p><strong>Telefone 2:</strong> <span id="telefone2"></span></p>

        <h2>Localização</h2>
        <p><strong>Endereço Completo:</strong> <span id="endereco"></span></p>
        <p><strong>Município:</strong> <span id="municipio"></span></p>

        <h2>Descrição do Serviço</h2>
        <p id="descricao_servico"></p>
    </div>

    <button id="downloadPdfButton">Baixar PDF</button>

    <script>
        // Função para obter parâmetros da URL
        function getQueryParams() {
            const params = new URLSearchParams(window.location.search);
            return Object.fromEntries(params.entries());
        }

        // Preenche os dados na página
        function preencherDados() {
            const data = getQueryParams();
            document.getElementById('tipo_servico').innerText = data.tipo_servico || "";
            document.getElementById('subserviço').innerText = data.subserviço || "";
            document.getElementById('detalhe').innerText = data.detalhe || "";
            document.getElementById('nome').innerText = data.nome || "";
            document.getElementById('email').innerText = data.email || "";
            document.getElementById('telefone1').innerText = data.telefone1 || "";
            document.getElementById('telefone2').innerText = data.telefone2 || "";
            document.getElementById('endereco').innerText = data.endereco || "";
            document.getElementById('municipio').innerText = data.municipio || "";
            document.getElementById('descricao_servico').innerText = data.descricao_servico || "";
        }

        document.getElementById("downloadPdfButton").addEventListener("click", function() {
            html2canvas(document.getElementById("pdf-content")).then(canvas => {
                const imgData = canvas.toDataURL("image/png");
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF();

                const imgWidth = 190;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                pdf.addImage(imgData, "PNG", 10, 10, imgWidth, imgHeight);
                pdf.save("relatorio.pdf");
            });
        });

        // Preencher dados na página ao carregar
        window.onload = preencherDados;
    </script>

</body>
</html>

